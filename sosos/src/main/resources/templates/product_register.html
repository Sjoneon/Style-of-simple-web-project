<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>상품 등록</title>
    <link rel="stylesheet" href="/css/style.css">
    <script>
        // 키워드 추가
        function addKeyword(keywordType) {
            const input = document.getElementById(`${keywordType}-input`);
            const keywordList = document.getElementById(`${keywordType}-list`);
            if (input.value.trim() !== '') {
                const li = document.createElement('li');
                li.textContent = input.value;
                li.innerHTML += ` <button onclick="removeKeyword(this)">삭제</button>`;
                keywordList.appendChild(li);
                input.value = '';
            }
        }

        // 키워드 삭제
        function removeKeyword(button) {
            button.parentElement.remove();
        }

        // 상품 등록
        async function submitForm(event) {
            event.preventDefault();

            const formData = new FormData(document.getElementById('productForm'));
            const keywords = {
                body: Array.from(document.querySelectorAll('#body-list li')).map(li => li.textContent.trim()),
                style: Array.from(document.querySelectorAll('#style-list li')).map(li => li.textContent.trim()),
                situation: Array.from(document.querySelectorAll('#situation-list li')).map(li => li.textContent.trim())
            };

            formData.append('keywords', JSON.stringify(keywords));

            const response = await fetch('/api/products', {
                method: 'POST',
                body: formData
            });

            if (response.ok) {
                alert('상품 등록 성공!');
                document.getElementById('productForm').reset();
            } else {
                const error = await response.text();
                alert(`상품 등록 실패: ${error}`);
            }
        }
    </script>
</head>
<body>
    <div class="content">
        <h2>상품 등록</h2>
        <form id="productForm" enctype="multipart/form-data" onsubmit="submitForm(event)">
            <input type="hidden" id="sellerId" name="sellerId" value="1">

            <!-- 상품 대표 이미지 -->
            <label for="image">대표 이미지:</label>
            <input type="file" id="image" name="image" accept="image/*" required><br>

            <!-- 상품명 -->
            <label for="name">상품명:</label>
            <input type="text" id="name" name="name" required><br>

            <!-- 카테고리 -->
            <label for="category">카테고리:</label>
            <select id="category" name="category" required>
                <option value="outer">OUTER</option>
                <option value="top">TOP</option>
                <option value="bottoms">BOTTOMS</option>
                <option value="set_clothes">SET CLOTHES</option>
                <option value="shoes">SHOES</option>
                <option value="bag_acc">BAG & ACC</option>
            </select><br>

            <!-- 가격 -->
            <label for="price">가격:</label>
            <input type="number" id="price" name="price" required><br>

            <!-- 수량 -->
            <label for="quantity">수량:</label>
            <input type="number" id="quantity" name="quantity" required><br>

            <!-- 상황별 점수 -->
            <label for="situationScore">상황별 점수:</label>
            <input type="number" id="situationScore" name="situationScore" min="0" max="100" required><br>

            <!-- 상세 설명 -->
            <label for="description">상세 설명:</label>
            <textarea id="description" name="description" rows="5" placeholder="상품에 대한 상세 설명을 입력하세요." required></textarea><br>

            <!-- 상세 설명 이미지 -->
            <label for="descriptionImage">상세 설명 이미지:</label>
            <input type="file" id="descriptionImage" name="descriptionImage" accept="image/*"><br>

            <!-- 신체 키워드 -->
            <h3>신체 키워드</h3>
            <input type="text" id="body-input">
            <button type="button" onclick="addKeyword('body')">추가</button>
            <ul id="body-list"></ul>

            <!-- 스타일 키워드 -->
            <h3>스타일 키워드</h3>
            <input type="text" id="style-input">
            <button type="button" onclick="addKeyword('style')">추가</button>
            <ul id="style-list"></ul>

            <!-- 상황 키워드 -->
            <h3>상황 키워드</h3>
            <input type="text" id="situation-input">
            <button type="button" onclick="addKeyword('situation')">추가</button>
            <ul id="situation-list"></ul>

            <button type="submit">상품 등록</button>
        </form>
        <button onclick="history.back()">뒤로가기</button>
    </div>
</body>
</html>
